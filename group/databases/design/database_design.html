<!DOCTYPE html>
<html lang="en">
    <head>
        <title>CS 370 - Group 1 Database Design</title>
        <style>
            div{font-family: Arial, Helvetica, sans-serif;}
            body{margin: 1in;}
            .tg  {border-collapse:collapse;border-spacing:0;}
            .tg td{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
              overflow:hidden;padding:10px 5px;word-break:normal;}
            .tg th{border-color:black;border-style:solid;border-width:1px;font-family:Arial, sans-serif;font-size:14px;
              overflow:hidden;padding:10px 5px;word-break:normal;}
            .tg .tg-0lax{text-align:left;vertical-align:top}
        </style>
    </head>
    <body>
        <!-- The document must include a title, your team name, 
            the time and date of last revision, and a statement of the document. purpose.-->
        <div>
            <h1 style="text-align: center;">Database Design Proposal</h1>
            <h2 style="text-align: center;">Group 1</h3>
            <h3>Last Revision: Nov 9th 2020</h3>
            <h3>Contact Info: ub4782@truman.edu</h3>
            <p>
            This document proposes a design for the database of the Override Tracking System. Currently, this system uses a MySQL database. The PHP interface that the logic team will use to interact with the databases is considered outside the scope of this document.
            </p>
            <p>
            Updates: Additional constraints are added to tables. Additionally, the course tables and request table have been modified to reflect changed in the logic team's API. Sections have been added to the database, as have attachements for requests.
            </p>
            <p>
            <b>Note</b>: An early version of this document used the term "class" instead of "course". This was changed to avoid confusion and technical problems associated with the use of the word "class" to refer to a concept in OOP.
            </p>
        </div>
        <div>
            <h3>1. Students</h3>
            <div><b>1.1. Student Table</b></div>
                first, we have the tables that hold the data for each student.
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">email</td>
                    <td class="tg-0lax">varchar(64)</td>
                    <td class="tg-0lax">UNIQUE, NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">first_name</td>
                    <td class="tg-0lax">varchar(255)</td>
                    <td class="tg-0lax"></td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">last_name</td>
                    <td class="tg-0lax">varchar(255)</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">banner_id</td>
                    <td class="tg-0lax">varchar(9)</td>
                    <td class="tg-0lax">UNIQUE, NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">grad_month</td>
                    <td class="tg-0lax">varchar(7)</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">standing</td>
                    <td class="tg-0lax">enum</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                </tbody>
                </table>
            <div><b>1.1.1.</b> Both the <code>email</code> and <code>banner_id</code> are unique to each user.</div>
            <div><b>1.1.2.</b> We anticipate the <code>email</code> field will be frequently used to search the table. For this reason, we will likely use it with an index. Since the user's email is used during the login process, we will always have that information availible, so require its value not be null.</div>
            <div><b>1.1.3.</b> The <code>banner_id</code> will be a string for compatibility with the API schema created by the logic team. It is a 9-digit value.</div>
            <div><b>1.1.4.</b> The <code>grad_month</code> will be stored in MM/YYYY format for compatibility with the API schema created by the logic team.</div>
            <div><b>1.1.5.</b> It should be noted that, in all of these tables, the <code>email</code> is stored as the local username since all email addresses are on the truman.edu domain.</div>
            <div><b>1.1.5.</b> A student's <code>standing</code> is "Freshman", "Sophomore", "Junior", or "Senior"</div>

            <br>
            <div><b>1.2. Majors and Minors Tables</b></div>
                We expect these two tables to look identical. The majors and minors available at Truman aren't static, they are added and removed from the catalog from time to time. Thus, we don't want to store them as an enum. Further more, each user can have multiple majors or minors. Thus, we create a tables for majors, a table for minors, and a table relating each user to their majors and minors. <br><br>

                First, the table for the majors
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">major</td>
                    <td class="tg-0lax">varchar(255)</td>
                    <td class="tg-0lax">UNIQUE, NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">active</td>
                    <td class="tg-0lax">boolean</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                </tbody>
                </table>

                the table for the minors
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">minor</td>
                    <td class="tg-0lax">varchar(255)</td>
                    <td class="tg-0lax">UNIQUE, NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">active</td>
                    <td class="tg-0lax">boolean</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                </tbody>
                </table>
                <br>

                And finally, the tables relating them
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">student_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY students(id)</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">major_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY majors(id)</td>
                  </tr>
                </tbody>
                </table>
                
                and
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">student_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY students(id)</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">minor_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY minors(id)</td>
                  </tr>
                </tbody>
                </table>
                <br>

            <div><b>1.2.1.</b> When a major or minor is first created, it will be active. Whenever a major or minor is removed, it will no longer be active. This means that it can still apear as a given user's major or minor, but it will not be an option for new users to select as their major or minor.</div>

            <h3>2. Faculty</h3>
            <div><b>2.1. Faculty Table</b></div>
                First, we store the basic information about each faculty member. Information like the <code>banner_id</code> and <code>grad_month</code> is only relavent to the students, so this table doesn't include those two columns.
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">email</td>
                    <td class="tg-0lax">varchar(64)</td>
                    <td class="tg-0lax">UNIQUE, NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">first_name</td>
                    <td class="tg-0lax">varchar(255)</td>
                    <td class="tg-0lax"></td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">last_name</td>
                    <td class="tg-0lax">varchar(255)</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                </tbody>
                </table>
            <div><b>2.1.1.</b> It should be noted that 1.1.2 is also relavent here.</div>
            <div><b>2.1.2.</b> The <code>email</code> field needs to be globally unique. That is, aside from being unique in this table, there also shouldn't be duplicate values in the student and faculty tables. This creates a one-to-one coorespondence that we can use to uniquely identify any user on the system.</div>

            <h3>3. Override Requests</h3>
            <div><b>3.1. Course Tables</b></div>
                This system will also have tables that store the possible departments, courses, and sections. We justify this using the same logic we use to seperate majors, the administator of this system may want to, for example, change what courses the system can currently be used with.<br><br>
                First, the departments
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">department</td>
                    <td class="tg-0lax">varchar(4)</td>
                    <td class="tg-0lax">UNIQUE, NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">active</td>
                    <td class="tg-0lax">boolean</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                </tbody>
                </table>

                the courses. These include a department and a course number. 
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">department_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY departments(id)</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">course_num</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">title</td>
                    <td class="tg-0lax">varchar(255)</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">active</td>
                    <td class="tg-0lax">boolean</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                </tbody>
                </table>
                
                the semesters
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">semester</td>
                    <td class="tg-0lax">varchar(6)</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">description</td>
                    <td class="tg-0lax">varchar(255)</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">active</td>
                    <td class="tg-0lax">boolean</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                </tbody>
                </table>

                and, finally, the sections.
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">course_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY courses(id)</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">semester_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY semesters(id)</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">section</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">crn</td>
                    <td class="tg-0lax">varchar(4)</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">active</td>
                    <td class="tg-0lax">boolean</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                </tbody>
                </table>
            <div><b>3.1.1.</b> The <code>department</code> is the prefix string. The "worst-case" we deal with are "STAT" and "MATH" with four letters, "CS" only has two.</div>
            <div><b>3.1.2.</b> The <code>course_num</code> will be stored as an int for compatibility with the API schema created by the logic team.</div>
            <div><b>3.1.3.</b> The <code>semester</code> and <code>crn</code> are numerical values stored as an strings for compatibility with the API schema created by the logic team.</div>
            <div><b>3.1.4.</b> The <code>semester</code> is a numberical code used internally (e.g., 202060).</div>
            <div><b>3.1.5.</b> <strike>The section <code>info</code> is the additional text used with the title of a semester. For example, if it's a writing enhanced section, it could just be the letters "WE". For special topics courses, it could be the title of the specific topics course offered in that section. This value would be appended to the <code>title</code> when displaying the course to the user.</strike> This field was deemed impractical, so removed.</div>
            <div><b>3.1.6.</b> The section <code>description</code> is a human readable version of the semester added for convenience (e.g., "Winter Interm 2020").</div>
            <div><b>3.1.7.</b> The statuses table was removed in favor of an enum</div>
            <div><b>3.1.8.</b> It should be noted that exactly one semester should be active at any given time, the semester the system is currenly acceping override requests for.</div>
            
            <br>
            <div><b>3.2. Override Requests Table</b></div>
                Finally, we can create override requests table.
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">student_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY students(id)</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">last_modified</td>
                    <td class="tg-0lax">datetime</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">section_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY sections(id)</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">status</td>
                    <td class="tg-0lax">enum</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">type</td>
                    <td class="tg-0lax">enum</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">explaination</td>
                    <td class="tg-0lax">text</td>
                    <td class="tg-0lax"></td>
                  </tr>
                </tbody>
                </table>
            <div><b>3.2.1.</b> <strike>The <code>crn</code> is a 4-digit value encouded as a string for compatibility with the API schema created by the logic team.</strike> The crn was removed and added to the sections table.</div>
            <div><b>3.2.2.</b> The <code>status</code> is "Received" at first, then can be changed to "Approved", "Provisionally Approved", or "Denied", or "Required Faculty Approval".</div>
            <div><b>3.2.3.</b> The <code>type</code> is "Closed Class", "Prerequisite Restriction", or "Other".</div>

            <br>
            <div><b>3.3. Attachments Table</b></div>
                Finally, we can create override requests table.
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">request_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY requests(id)</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">name</td>
                    <td class="tg-0lax">varchar(255)</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">path</td>
                    <td class="tg-0lax">text</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                </tbody>
                </table>
            <div><b>3.3.1.</b> The <code>name</code> is the original file name, kept in case we need to change the file name to ensure uniqueness.</div>
            <div><b>3.3.2.</b> The <code>path</code> is the location of the file in the server's filesystem.</div>

            <h3>4. Notifications</h3>
            <div><b>4.1. Notification Table</b></div>
                <table class="tg">
                <thead>
                  <tr>
                    <th class="tg-0lax">Column Name</th>
                    <th class="tg-0lax">Data Type</th>
                    <th class="tg-0lax">Attributes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="tg-0lax">id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">PRIMARY KEY, AUTO_INCREMENT</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">request_id</td>
                    <td class="tg-0lax">int</td>
                    <td class="tg-0lax">NOT NULL, FOREIGN KEY requests(id)</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">sender_email</td>
                    <td class="tg-0lax">varchar(64)</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">receiver_email</td>
                    <td class="tg-0lax">varchar(64)</td>
                    <td class="tg-0lax">NOT NULL</td>
                  </tr>
                  <tr>
                    <td class="tg-0lax">body</td>
                    <td class="tg-0lax">text</td>
                    <td class="tg-0lax"></td>
                  </tr>
                </tbody>
                </table>
            <div><b>4.1.1.</b> Here, we use emails to indicate the sender and receiver. Either of these can be any user in the system, students or faculty. Recall from 2.1.2 that emails are globally unique, so this is sufficient to indicate which user in the system is related to the message.</div>

        </div>
    </body>
</html>
